Veja abaixo como solucionar alguns erros que podem ocorrer durante a operação da Suíte Saber e/ou do ABCD.

= ABCD =

== Eliminação do excesso de SPAN ==

O SPAN provoca mal funcionamento do CSS e pode ser encontrado em determinados arquivos do ABCD.

Exemplo de como a linha é apresentada:

{{{
<span><strong>".$msgstr["cancel"]."</strong></span>
}}}

== Solução ==

Acesse a pasta:

||  .../central/dbadmin/ ||

remova o SPAN dos seguintes arquivos:

|| *Arquivo* || *Linha* ||
|| fdt.php || 1252 ||
|| fdt_short_a.php || 1388 ||
|| fixed_marc.php || 67 ||
|| fst.php || 195 ||
|| fmt.php || 337 ||
|| iah_edit_db.php || 1488 - 1498 ||
|| pft.php || 1190 ||
|| typeofrecs.php || 78 ||
|| advancedsearch.php || 195 ||
|| databases_list.php || 104 ||
|| editpar.php || 74 ||
|| help_ed.php || 221 ||
|| crearbd_ex_copy.php || 340 ||
|| menu_creardb.php ||175 ||
|| menu_mantenimiento.php || 103 ||
|| typeofrecs_marc_edit.php || 219 ||

Acesse também a pasta:

|| .../central/statistics/ ||

remova o SPAN dos seguintes arquivos:

|| *Arquivo* || *Linha* ||
|| config_vars.php || 424 - 430 ||
|| tables_cfg.php || 451 - 460 ||

== Logo da instituição ==

Até a versão 1.2b1 do ABCD, o logotipo possui chamadas diferentes. Caso você troque o logotipo no arquivo *config.php* e ele não seja alterado em todas as telas, faça o procedimento abaixo.

== Solução ==

Acesse o arquivo:

|| ...\htdocs\central\config.php ||

adicione:

{{{			
$institution_logo="/ABCD/www/htdocs/central/images/tools.png";
}}}

Acesse os arquivos:

|| ...\htdocs\index.php ||
|| ...\htdocs\central\dataentry\menubases.php ||
|| ...\htdocs\central\common\institutional_info.php ||

	   
altere a linha do logo da instituição para:

{{{
<img src="<?php $institution_logo?>" alt="Logo do <?php echo $institution_name?>" align="left" />
}}}

== Alterar título das janelas ==

É possível inserir o nome da instituição desejada como título de cada janela. Para definir o nome de cada tela, siga as instruções abaixo:

*Tela inicial (exibida antes do login)*

Acesse o arquivo:

|| ...\htdocs\index.php ||
		    
insira a tag:

{{{
<title><?php echo $institution_name?></title>
}}}

*Tela inicial (exibida após o login)*

Acesse o arquivo:

|| ...\htdocs\central\common\header.php ||

insira a tag:

{{{
<title><?php echo $institution_name?></title>			
}}}

*Catalogação*

Acesse o arquivo:

|| ...\htdocs\central\dataentry\inicio_main.php ||

insira a tag:

{{{
echo "<HTML><title>$institution_name</title>
}}}

Para informar as definições da nova janela (quando escolhida esta opção no login) e alterar logo do cabeçalho, acesse o arquivo:

|| ...\htdocs\index.php ||

altere para:

{{{
<img src="<?php echo $institution_logo?>" alt="Logo do <?php echo $institution_name?>" align="left" />
}}}
			
Logo após, acesse o arquivo:

|| ...\htdocs\central\common\institutional_info.php ||

altere para:

{{{
<img src="<?php echo $institution_logo?>" alt="Logo do <?php echo $institution_name?>" align="left" />
}}}

== Favicon ==

Para adiconar um favicon, acesse o arquivo:

|| ...\htdocs\index.php ||
						
adicione:

{{{
<link rel="shortcut icon" href="central/images/favicon.ico" />
}}}
			
No arquivo:

|| ...\htdocs\central\common\header.php ||
	
adicione:

{{{
<link rel="shortcut icon" href="../images/favicon.ico" />
}}}

== Organizar breadcrumb ==

Para realizar esta ação, é necessário acessar os arquivos abaixo:
						
|| ...\htdocs\central\dbadmin\trad_ayudas_dataentry.php ||
|| ...\htdocs\central\dbadmin\translate.php ||
|| ...\htdocs\central\dbadmin\translate_update.php ||
|| ...\htdocs\central\dbadmin\trad_ayudas_dataentry.php ||
|| ...\htdocs\central\dbadmin\trad_ayudas_statistics.php ||
|| ...\htdocs\central\dbadmin\trad_ayudas_adm.php ||			
|| ...\htdocs\central\dbadmin\advancedsearch_update.php ||	
|| ...\htdocs\central\dbadmin\pft_update.php ||
|| ...\htdocs\central\dbadmin\actualizararchivotxt.php ||
						
alterar o seguinte trecho:

{{{
echo " <body>
				<div class=\"sectionInfo\">
						<div class=\"breadcrumb\">"."<h5>".
							$msgstr["tradyudas"]."</h5>
						</div>
						<div class=\"actions\">

				";
}}}

para:

{{{
				echo "
					<div class=\"sectionInfo\">
					<div class=\"breadcrumb\">".
					$msgstr["tradyudas"]."
					</div>
					<div class=\"actions\">\n";
}}}


== Mudar a cor da exibição "Script:" ==

A cor branca foi fixada em todas as páginas que exibem o script que está sendo usado. No caso de customizações do tema, é preciso remover a chamada *color=white* de todos os arquivos *.php*.

== Solução ==

Localize, em cada um dos arquivos listados abaixo, o comando *<font color=white>*:

Exemplo: Script: databases_list.php. Localizar: <font color=white>

{{{
echo "<font color=white>    Script: inicio_base.php" ?>
					</font>
}}}

remova a chamada <font> da linha:

				    echo "    Script: inicio_base.php" ?>
			Original (com algumas variações de localização do </font>:
					echo "<font color=white>    Script: inicio_base.php" ?>
					</font>

Lista de arquivos que possuem a tag *<font color=white>*:

 * ...\htdocs\central\config.php

  * ...\htdocs\central\dataentry\inicio_base.php
  * ...\htdocs\central\dataentry\alfa.php
  * ...\htdocs\central\dataentry\administrar.php
  * ...\htdocs\central\dataentry\administrar_ex.php

  * ...\htdocs\central\statistics\tables_generate_ex.php
  * ...\htdocs\central\statistics\config_vars.php
  * ...\htdocs\central\statistics\config_vars_update.php
  * ...\htdocs\central\statistics\tables_cfg.php
  * ...\htdocs\central\statistics\tables_cfg_update.php

  * ...\htdocs\central\dbadmin\copies_linkdb.php
  * ...\htdocs\central\dbadmin\pft.php
  * ...\htdocs\central\dbadmin\pft_delete.php
  * ...\htdocs\central\dbadmin\assign_control_number.php
  * ...\htdocs\central\dbadmin\advancedsearch.php
  * ...\htdocs\central\dbadmin\advancedsearch_update.php
  * ...\htdocs\central\dbadmin\fdt_short_a.php
  * ...\htdocs\central\dbadmin\fdt.php
  * ...\htdocs\central\dbadmin\editpar.php
  * ...\htdocs\central\dbadmin\dirtree.php
  * ...\htdocs\central\dbadmin\delete_file.php
  * ...\htdocs\central\dbadmin\databases_list.php
  * ...\htdocs\central\dbadmin\crearbd_new_create.php
  * ...\htdocs\central\dbadmin\crearbd_ex_copy.php
  * ...\htdocs\central\dbadmin\fst_update.php
  * ...\htdocs\central\dbadmin\fst.php
  * ...\htdocs\central\dbadmin\fmt_update.php
  * ...\htdocs\central\dbadmin\delete_file.php
  * ...\htdocs\central\dbadmin\fmt.php
  * ...\htdocs\central\dbadmin\fixed_marc.php
  * ...\htdocs\central\dbadmin\z3950_diacritics_update.php
  * ...\htdocs\central\dbadmin\z3950_diacritics_edit.php
  * ...\htdocs\central\dbadmin\z3950_conversion.php
  * ...\htdocs\central\dbadmin\z3950_conf.php
  * ...\htdocs\central\dbadmin\winisis_upload_pft.php
  * ...\htdocs\central\dbadmin\winisis_upload_fst.php
  * ...\htdocs\central\dbadmin\winisis_upload_fdt.php
  * ...\htdocs\central\dbadmin\winisis.php
  * ...\htdocs\central\dbadmin\users_adm.php
  * ...\htdocs\central\dbadmin\typeofrecs_marc_edit.php
  * ...\htdocs\central\dbadmin\typeofrecs_edit.php
  * ...\htdocs\central\dbadmin\typeofrecs.php
  * ...\htdocs\central\dbadmin\trad_ayudas_utils.php
  * ...\htdocs\central\dbadmin\trad_ayudas_estadisticas.php
  * ...\htdocs\central\dbadmin\trad_ayudas_adm.php
  * ...\htdocs\central\dbadmin\trad_ayudas_dataentry.php
  * ...\htdocs\central\dbadmin\trad_ayudas_adm.php
  * ...\htdocs\central\dbadmin\sortkey_update.php
  * ...\htdocs\central\dbadmin\sortkey_edit.php
  * ...\htdocs\central\dbadmin\help_ed.php
  * ...\htdocs\central\dbadmin\resetautoinc_update.php
  * ...\htdocs\central\dbadmin\resetautoinc.php
  * ...\htdocs\central\dbadmin\reset_control_number.php
  * ...\htdocs\central\dbadmin\recval.php
  * ...\htdocs\central\dbadmin\profile_edit.php
  * ...\htdocs\central\dbadmin\picklist_save.php
  * ...\htdocs\central\dbadmin\picklist_edit.php
  * ...\htdocs\central\dbadmin\picklist.php
  * ...\htdocs\central\dbadmin\menu_traducir.php
  * ...\htdocs\central\dbadmin\menu_modificardb.php
  * ...\htdocs\central\dbadmin\menu_traducir.php
  * ...\htdocs\central\dbadmin\menu_mantenimiento.php
  * ...\htdocs\central\dbadmin\iah_save.php
  * ...\htdocs\central\dbadmin\profile_save.php

 * ...\htdocs\central\common\homepage.php

\htdocs\central\acquisitions\decision_ex.php
\htdocs\central\acquisitions\decision.php
\htdocs\central\acquisitions\copies_create
\htdocs\central\acquisitions\close_order.php
\htdocs\central\acquisitions\bidding_ex.php
\htdocs\central\acquisitions\bidding.php
\htdocs\central\acquisitions\suggestions_status_ex.php
\htdocs\central\acquisitions\suggestions_status.php
\htdocs\central\acquisitions\suggestions_search.php
\htdocs\central\acquisitions\suggestions_new_update.php
\htdocs\central\acquisitions\suggestions_new.php
\htdocs\central\acquisitions\resetautoinc.php
\htdocs\central\acquisitions\receive_order_update.php
\htdocs\central\acquisitions\receive_order_ex.php
\htdocs\central\acquisitions\receive_order.php
\htdocs\central\acquisitions\pending_order_ex.php
\htdocs\central\acquisitions\pending_order.php
\htdocs\central\acquisitions\order_update.php
\htdocs\central\acquisitions\order_new_update.php
\htdocs\central\acquisitions\order_new.php
\htdocs\central\acquisitions\order_ex.php
\htdocs\central\acquisitions\order.php
\htdocs\central\acquisitions\object_create.php

\htdocs\central\circulation\typeofusers_update.php
\htdocs\central\circulation\typeofusers.php
\htdocs\central\circulation\typeofloans.php
\htdocs\central\circulation\typeofitems_update.php
\htdocs\central\circulation\typeofitems.php
\htdocs\central\circulation\situacion_de_un_objeto_ex.php
\htdocs\central\circulation\situacion_de_un_objeto.php
\htdocs\central\circulation\sanctions_ex.php
\htdocs\central\circulation\sanctions.php
\htdocs\central\circulation\reservas_eliminar_ex.php
\htdocs\central\circulation\reports_menu_recsel.php
\htdocs\central\circulation\reports_menu.php
\htdocs\central\circulation\renovar.php
\htdocs\central\circulation\prestar_procesar.php
\htdocs\central\circulation\prestar.php
\htdocs\central\circulation\prestamo_disponibilidad.php
\htdocs\central\circulation\menu_statistics.php         // depois de tirar a font, colocar linha anterior, pra não quebrar o código.
\htdocs\central\circulation\locales.php
\htdocs\central\circulation\loanobjects.php
\htdocs\central\circulation\loan_return_reserve.php
\htdocs\central\circulation\item_history_ex.php
\htdocs\central\circulation\item_history.php
\htdocs\central\circulation\estado_de_cuenta.php
\htdocs\central\circulation\devolver.php
\htdocs\central\circulation\databases_configure.php
\htdocs\central\circulation\databases.php
\htdocs\central\circulation\configure_menu.php
\htdocs\central\circulation\calendario.php
\htdocs\central\circulation\borrowers_configure.php
\htdocs\central\circulation\borrower_history_ex.php
\htdocs\central\circulation\borrower_history.php
\htdocs\central\circulation\usuario_prestamos_reservar.php
\htdocs\central\circulation\usuarios_prestamos_presentar.php
\htdocs\central\circulation\usuario_prestamo_presentar.php
\htdocs\central\circulation\usuario_prestamos_presentar.php

== Índice do empréstimo ==

Ao clicar em uma das letras do índice utilizado para realizar a busca pelo número de registro do item e número do usuário, a janela de empréstimo (*prestar.php*) é fechada.

== Solução ==

Acesse o seguinte arquivo:

|| ...\central\circulation\capturaclaves.php ||

Logo após, busque pela linha e delete o comando *;self.close()*.

{{{
<td  bgcolor=#cccccc align=center><font size=1 face="arial"><? for ($i=65;$i<91;$i++ ) echo "<a href=javascript:AbrirIndice('".chr($i)."');self.close()>".chr($i)."</a>  "?></td>
}}}

== Erro ao informar números de registros ==

Ao colocar um número de usuário inexistente, é possível que seja exibida uma mensagem contendo esta informação (borrower statement - estado_de_cuenta.php).

Também ao colocar um número de registro de item que não está emprestado, uma tela em branco com a mensagem "unautorized user" surgirá.

== Solução ==

Busque as linhas 160-166 do arquivo:

|| ...\central\circulation\loan_return_reserve.php ||

substitua o trecho *El número de inventario no está prestado* por *".$msgstr["inventory"]." ".$msgstr["noloan"]."*, conforme é mostrado abaixo:

{{{
 if (isset($arrHttp["error"]) and $arrHttp["inventory"]!=""){
       echo "
       <script>
       alert('".$arrHttp["inventory"].": El número de inventario no está prestado')
       </script>
       ";
}
}}}

para:

{{{
if (isset($arrHttp["error"]) and $arrHttp["inventory"]!=""){
        echo "
        <script>
        alert('".$arrHttp["inventory"].": ".$msgstr["inventory"]." ".$msgstr["noloan"]."')
        </script>
        ";
}
}}}

== Link para histórico do usuário ==

Dentro de cada submenu integrante da aba de Transações, é possível visualizar os links para alternar entre cada função de transação. Estes links não, porém, não estão disponíveis no submenu de Histórico do Leitor.

== Solução ==

Vá até o arquivo:

|| .../central/circulation/borrower_history.php ||

busque as tags abaixo:

{{{
<div class="actions"></div>
}}}

entre elas, acrescente o seguinte código:

{{{
<?php include("submenu_prestamo.php");?>
}}}

----

= Bases de dados =

== Importação de arquivos ==

Ao tentar realizar o upload de um arquivo, é possível que a seguinte mensagem seja exibida:

|| Warning: Invalid argument supplied for foreach() in C:\abcd\www\htdocs\central\dataentry\upload.php on line 16 ||

== Soluções ==

 # Aumentar o Timeout;
 # Aumentar o tamanho permitido para o envio de arquivos.

Para aumentar o tamanho máximo permitido para o envio de arquivos, acesse o *php.ini* do servidor, conforme é mostrado abaixo.

{{{
; Whether to allow HTTP file uploads.
file_uploads = On

; Temporary directory for HTTP uploaded files (will use system default if not
; specified).
;upload_tmp_dir =

; Maximum allowed size for uploaded files.
upload_max_filesize = 2M
}}}

O servidor, por padrão, é configurado para carregar arquivos inferiores ou iguais a 2MB. Portanto, para carregar um arquivo maior, altere este valor.

----

= Empréstimo =

== Transações ==

No Módulo de Empréstimo, na opção Transações, que se encontra na aba Base de Dados, a seta do botão *« Last* está errada.

== Solução ==

Busque as linhas 365 [v. 1.0.3] ou 393 [v. 1.0.5] do arquivo:

|| ...\central\dataentry\browse.php alterar: ||

Logo após, substitua a seta em:

{{{
« <?php echo $msgstr["last"]?>
}}}

por:

{{{
» <?php echo $msgstr["last"]?>
}}}

Caso não seja possível visualizar a seta, mas sim sua linguagem CSS, substitua:

{{{
&#171; <?php echo $msgstr["last"]?>
}}}

por:

{{{
&#187; <?php echo $msgstr["last"]?>
}}}

----

= OPAC =

== Formatação da referência (conforme ABNT) ==

Para realizar a formatação de referências conforme a ABNT, altere ou crie, caso não exista, o arquivo ...\www\bases\[base]\pfts\[lang]\cite.pft e copie para o arquivo o código abaixo:

{{{
'Referência conforme ABNT NBR 6023:2002.'
'<br /><br />'
mdl,v100^a,v110^a,v111^a,v130^a,
if p(v222^b) then
	mhl,v222^a," : "v222^b,
else
	mdl,v222^a,
fi,
if p(v245^b) then
	mhl,'<strong>'v245^a'</strong>',if p(v245^h) then mhl else mdl fi," : "v245^b,
else
	if p(v245^h) then mhl else mdl fi,'<strong>'v245^a'</strong>',
fi,
" ["v245^h"]. ",
mdl,v250^a, 
mhl,v260^a" : ",v260^b", ",mdl, v260^c,
v300^a,
mhl,if p(v440) then '(',(v440^a,|, n.|v440^n,|, |v440^v, if occ < nocc(v440) then '; ' fi,) ')'/ fi,
/#,
}}}

== Definir a última base de dados como padrão ==

Para manter a última base de dados selecionada por padrão na lista suspensa do painel principal, vá até o arquivo:

|| ...\www\htdocs\central\common\homepage.php ||

insira a expressão *selected* na linha 267:

{{{
	    echo "<option selected value=\"^a$key^badm|$value\" $xselected>".$t[0]."\n";
}}}

== Definir a primeira base de dados como padrão ==

Para manter a primeira base de dados selecionada por padrão na lista suspensa do painel principal, vá até o arquivo:

|| ...\www\htdocs\central\common\homepage.php ||

O termo *selected*, mencionado anteriormente, não deverá ser utilizado. Ao invés disso, altere *ix<1* para *ix<-1* na linha 97, conforme é mostrado abaixo:

{{{
    function CambiarBaseAdministrador(Modulo){
		if (Modulo!="traducir"){
			ix=document.admin.base.selectedIndex
		    if (ix<-1){
				alert("<?php echo $msgstr["seldb"]?>")
				return
		    }
		}
}}}

== Melhorar a aparência da barra de ferramentas de catalogação ==

Para alterar as configurações relacionadas à aparência da barra de ferramentas do menu de catalogação, busque o arquivo:

|| ...\www\htdocs\central\dataentry\js\dhtmlXToolbar.css ||

adicione:

{{{
width:25px;
}}}                       

em:

{{{
.defaultbutton
.defaultbuttondown
.defaultbuttonover
}}}